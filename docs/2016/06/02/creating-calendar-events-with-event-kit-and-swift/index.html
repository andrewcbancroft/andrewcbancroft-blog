<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111087893-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-111087893-1');
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6356224024630676",
            enable_page_level_ads: true
        });
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Creating Calendar Events with Event Kit and Swift" />
<meta property="og:description" content="Folks have asked more about working with Event Kit and Swift, so the series continues with this guide on how to create calendar events with Event Kit and Swift!
Previous guides in the series include the following:
Previous Guides    Beginner’s Guide to Event Kit in Swift – Requesting Permission    Creating Calendars with Event Kit and Swift    Listing Calendar Events with Event Kit and Swift" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andrewcbancroft.com/2016/06/02/creating-calendar-events-with-event-kit-and-swift/" />
<meta property="article:published_time" content="2016-06-02T17:37:15&#43;00:00"/>
<meta property="article:modified_time" content="2016-06-02T17:37:15&#43;00:00"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Creating Calendar Events with Event Kit and Swift"/>
<meta name="twitter:description" content="Folks have asked more about working with Event Kit and Swift, so the series continues with this guide on how to create calendar events with Event Kit and Swift!
Previous guides in the series include the following:
Previous Guides    Beginner’s Guide to Event Kit in Swift – Requesting Permission    Creating Calendars with Event Kit and Swift    Listing Calendar Events with Event Kit and Swift"/>
<meta name="generator" content="Hugo 0.55.4" /> 
    
    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Creating Calendar Events with Event Kit and Swift",
  "url": "https:\/\/www.andrewcbancroft.com\/2016\/06\/02\/creating-calendar-events-with-event-kit-and-swift\/",
  "wordCount": "683",
  "datePublished": "2016-06-02T17:37:15\x2b00:00",
  "dateModified": "2016-06-02T17:37:15\x2b00:00",
  "author": {
    "@type": "Person",
    "name": "Andrew"
  },
  "keywords": "Swift, Event Kit"
}
</script>



    <title>Creating Calendar Events with Event Kit and Swift</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://www.andrewcbancroft.com/css/custom.css" rel="stylesheet"> 
    <link href="https://www.andrewcbancroft.com/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">
        
    <link href="" rel="alternate" type="application/rss+xml" title="Andrew Bancroft" /> 
    
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://www.andrewcbancroft.com">Andrew Bancroft</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            Notes
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://www.andrewcbancroft.com#sql-server-notes">SQL Server</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                Blog Articles
                            </a>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#azure">Azure</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#dimensional-modeling">Dimensional Modeling</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#general-data-concepts">General Data Concepts</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#machine-learning">Machine Learning</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#r">R</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#sql-server">SQL Server</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#statistics">Statistics</a>
                            </div>
                        </li>
                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            About
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://www.andrewcbancroft.comabout/andrew_bancroft/">About Andrew</a>
                            <a class="dropdown-item" href="https://github.com/andrewcbancroft">GitHub</a>
                            <a class="dropdown-item" href="https://www.linkedin.com/in/andrewcbancroft/">LinkedIn</a>
                            <a class="dropdown-item" href="https://twitter.com/andrewcbancroft">Twitter</a>
                            <a class="dropdown-item" href="https://www.youtube.com/channel/UCDPV9kMhP-b5EFRI7d812pg">YouTube</a>
                            <a class="dropdown-item" href="https://www.pluralsight.com/authors/andrew-bancroft">Pluralsight Courses</a>
                            <a class="dropdown-item" href="https://www.andrewcbancroft.com">www.andrewcbancroft.com</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                


<article>
  <div class="article">
    <header>
      <h1 class="article-title">Creating Calendar Events with Event Kit and Swift</h1>
    </header>
    <div class="content">

    

<p>Folks have asked more about working with Event Kit and Swift, so the series continues with this guide on how to create calendar events with Event Kit and Swift!</p>

<p>Previous guides in the series include the following:</p>

<div class="resources">
  <div class="resources-header">
    Previous Guides
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fa fa-link"></i> <a href="https://www.andrewcbancroft.com/2015/05/14/beginners-guide-to-eventkit-in-swift-requesting-permission/" title="Beginner’s Guide to Event Kit in Swift – Requesting Permission">Beginner’s Guide to Event Kit in Swift – Requesting Permission</a>
    </li>
    <li>
      <i class="fa fa-link"></i> <a href="https://www.andrewcbancroft.com/2015/06/17/creating-calendars-with-event-kit-and-swift/" title="Creating Calendars with Event Kit and Swift">Creating Calendars with Event Kit and Swift</a>
    </li>
    <li>
      <i class="fa fa-link"></i> <a href="https://www.andrewcbancroft.com/2016/04/28/listing-calendar-events-with-event-kit-and-swift/" title="Listing Calendar Events with Event Kit and Swift">Listing Calendar Events with Event Kit and Swift</a>
    </li>
  </ul>
</div></p>

<div class="resources">
  <div class="resources-header">
    Jump to&#8230;
  </div>
  

<p><ul class="resources-content">
    <li>
      <a href="#demo">Demo</a>
    </li>
    <li>
      <a href="#code-example">Code Example</a>
    </li>
    <li>
      <a href="#code-walkthrough">Code Walkthrough</a>
    </li>
    <li>
      <a href="#gotchas">Gotchas</a>
    </li>
    <li>
      <a href="#related">You might also enjoy&#8230;</a>
    </li>
    <li>
      <a href="#share">Was this article helpful? Please share!</a>
    </li>
  </ul>
</div></p>

<p><a name="demo" class="jump-target"></a></p>

<h1 id="demo">Demo</h1>

<p>Here&#8217;s what we&#8217;re going for by the end of this:</p>

<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2016/05/create-events-demo.gif"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2016/05/create-events-demo.gif" alt="Create Events Demo" width="468" height="847" class="alignnone size-full wp-image-12890" /></a></p>

<p>As with my other guides, I&#8217;ve included a working project on GitHub for you to peruse and tinker with:</p>

<div class="resources">
  <div class="resources-header">
    Resources
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fa fa-github fa-lg"></i> <a href="https://github.com/andrewcbancroft/EventTracker/tree/create-events" title="Event Tracker - Create Events">Event Tracker – Create Events</a>
    </li>
  </ul>
</div></p>

<p><a name="code-example" class="jump-target"></a></p>

<h1 id="code-example">Code Example</h1>

<p>The majority of the work to create an event happens in the example project&#8217;s AddEventViewController.swift file, so that&#8217;s where I&#8217;ll spend my time in this guide. First, let&#8217;s put the relevant code before us:</p>

<pre class="lang:swift decode:true " title="AddEventViewController.swift" >class AddEventViewController: UIViewController {

    var calendar: EKCalendar! // Intended to be set in parent controller's prepareForSegue event

    @IBOutlet weak var eventNameTextField: UITextField!
    @IBOutlet weak var eventStartDatePicker: UIDatePicker!
    @IBOutlet weak var eventEndDatePicker: UIDatePicker!

    // ...

    @IBAction func addEventButtonTapped(sender: UIBarButtonItem) {
        // Create an Event Store instance
        let eventStore = EKEventStore();
        
        // Use Event Store to create a new calendar instance
        if let calendarForEvent = eventStore.calendarWithIdentifier(self.calendar.calendarIdentifier)
        {
            let newEvent = EKEvent(eventStore: eventStore)
            
            newEvent.calendar = calendarForEvent
            newEvent.title = self.eventNameTextField.text ?? "Some Event Name"
            newEvent.startDate = self.eventStartDatePicker.date
            newEvent.endDate = self.eventEndDatePicker.date
            
            // Save the calendar using the Event Store instance
            
            do {
                try eventStore.saveEvent(newEvent, span: .ThisEvent, commit: true)
                delegate?.eventDidAdd()
                
                self.dismissViewControllerAnimated(true, completion: nil)
            } catch {
                let alert = UIAlertController(title: "Event could not save", message: (error as NSError).localizedDescription, preferredStyle: .Alert)
                let OKAction = UIAlertAction(title: "OK", style: .Default, handler: nil)
                alert.addAction(OKAction)
                
                self.presentViewController(alert, animated: true, completion: nil)
            }
        }
     }

     // ...
}</pre>

<p><a name="code-walkthrough" class="jump-target"></a></p>

<h1 id="code-walkthrough">Code Walkthrough</h1>

<p>The general outline of the code is this:</p>

<ul>
<li>Create an instance of <code>EKEventStore</code> &#8211; this will let you create <code>EKEvents</code> and save them.</li>
</ul>

<pre class="lang:swift decode:true " title="AddEventViewController.swift" >let newEvent = EKEvent(eventStore: eventStore)</pre>

<ul>
<li>Pull an <code>EKCalendar</code> instance from the Event Store &#8211; this will let you associate an event with a calendar.</li>
</ul>

<pre class="lang:swift decode:true " title="AddEventViewController.swift" >if let calendarForEvent = eventStore.calendarWithIdentifier(self.calendar.calendarIdentifier) { 
// ... 
}
</pre>

<ul>
<li>Create a new <code>EKEvent</code> instance and set its properties.</li>
</ul>

<pre class="lang:swift decode:true " title="AddEventViewController.swift" >let newEvent = EKEvent(eventStore: eventStore)
            
newEvent.calendar = calendarForEvent
newEvent.title = self.eventNameTextField.text ?? "Some Event Name"
newEvent.startDate = self.eventStartDatePicker.date
newEvent.endDate = self.eventEndDatePicker.date</pre>

<ul>
<li>Attempt to save the event with the <code>EKEventStore</code> instance that was created first.</li>
</ul>

<pre class="lang:swift decode:true " title="AddEventViewController.swift" >do {
    try eventStore.saveEvent(newEvent, span: .ThisEvent, commit: true)
    delegate?.eventDidAdd()
    
    self.dismissViewControllerAnimated(true, completion: nil)
} catch {
    let alert = UIAlertController(title: "Event could not save", message: (error as NSError).localizedDescription, preferredStyle: .Alert)
    let OKAction = UIAlertAction(title: "OK", style: .Default, handler: nil)
    alert.addAction(OKAction)
    
    self.presentViewController(alert, animated: true, completion: nil)
}</pre>

<p><a name="gotchas" class="jump-target"></a></p>

<h1 id="gotchas">Gotchas</h1>

<p>As I was working through this example, I was initially running into trouble when associating my <code>newEvent</code> with the <code>calendar</code> that was passed into <code>AddEventViewController</code> from the parent controller&#8217;s <code>prepareForSegue</code> method.</p>

<p>It turns out that if you retrieve a calendar from one <code>EKEventStore</code> instance, say, in the previous view controller, and attempt to assign it to an <code>EKEvent</code> that is associated with a <em>different</em> <code>EKEventStore</code> instance, things become really unhappy when it comes time to save the event.</p>

<p>Specifically, you&#8217;ll get an error that says &#8220;Thread 1: signal SIGKILL&#8221; followed by &#8220;Thread 1: EXC_BAD_ACCESS&#8221;:</p>

<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventSigKillError.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventSigKillError.png" alt="Save Event Sig Kill Error" width="753" height="177" class="alignnone size-full wp-image-12898" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventSigKillError.png 753w, https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventSigKillError-300x71.png 300w" sizes="(max-width: 753px) 100vw, 753px" /></a></p>

<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventBadAccessError.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventBadAccessError.png" alt="Save Event Bad Access Error" width="755" height="343" class="alignnone size-full wp-image-12899" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventBadAccessError.png 755w, https://www.andrewcbancroft.com/wp-content/uploads/2016/06/SaveEventBadAccessError-300x136.png 300w" sizes="(max-width: 755px) 100vw, 755px" /></a></p>

<p>The fix for this was easy, once I figured out what was going on: Simply re-retrieve a calendar instance using an appropriate <code>calendarIdentifier</code> <em>from the <code>EKEventStore</code> instance you&#8217;re using to save the <code>EKEvent</code> with</em>:</p>

<pre class="lang:swift mark:1,5 decode:true " title="calendarForEvent Snippet" >if let calendarForEvent = eventStore.calendarWithIdentifier((self.calendar.calendarIdentifier))
{
    let newEvent = EKEvent(eventStore: eventStore)
    
    newEvent.calendar = calendarForEvent
    
    // ...
}</pre>

<h1 id="wrapping-up">Wrapping up</h1>

<p>My focus in this guide was to demonstrate how to create and save and event to a user&#8217;s calendar. I intentionally left out a lot of the navigation aspects and <code>prepareForSegue</code> calls in order to highlight the event creation process itself. Be sure to check out the <a href="https://github.com/andrewcbancroft/EventTracker/tree/create-events">accompanying Xcode project on GitHub</a> for full details on the flow of the application.</p>

<p><a name="related" class="jump-target"></a></p>

<div class="resources">
  <div class="resources-header">
    You might also enjoy&#8230;
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/05/14/beginners-guide-to-eventkit-in-swift-requesting-permission/" title="Beginner’s Guide to Event Kit in Swift – Requesting Permission">Beginner’s Guide to Event Kit in Swift – Requesting Permission</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/06/17/creating-calendars-with-event-kit-and-swift/" title="Creating Calendars with Event Kit and Swift">Creating Calendars with Event Kit and Swift</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2016/04/28/listing-calendar-events-with-event-kit-and-swift/" title="Listing Calendar Events with Event Kit and Swift">Listing Calendar Events with Event Kit and Swift</a>
    </li>
  </ul>
</div></p>

<p><a name="share" class="jump-target"></a></p>


    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andrewcbancroft" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </article>



            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 146 pages and is available on <a href="https://github.com/andrewcbancroft/datadaylife-blog">GitHub</a>. Copyright &copy; Andrew Bancroft, <time datetime="2019">2019</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>