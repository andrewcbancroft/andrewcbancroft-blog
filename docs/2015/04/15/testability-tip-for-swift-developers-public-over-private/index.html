<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-111087893-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-111087893-1');
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6356224024630676",
            enable_page_level_ads: true
        });
    </script>

    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Testability Tip for Swift Developers – Public Over Private" />
<meta property="og:description" content="Quite often in unit testing, especially when practicing Test-Driven Development, I find myself wanting to test every single line of code. When I run up against a private function, however, I often scratch my head and ask, &#8220;How am I supposed to test this??&#8221;.
Most experienced testers will tell you, &#8220;Don't test private implementation – only public API&#8221;.
&#8220;Okay&#8230; But how, does that private function get tested?&#8221;, I always asked." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andrewcbancroft.com/2015/04/15/testability-tip-for-swift-developers-public-over-private/" />
<meta property="article:published_time" content="2015-04-15T18:52:11&#43;00:00"/>
<meta property="article:modified_time" content="2015-04-15T18:52:11&#43;00:00"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Testability Tip for Swift Developers – Public Over Private"/>
<meta name="twitter:description" content="Quite often in unit testing, especially when practicing Test-Driven Development, I find myself wanting to test every single line of code. When I run up against a private function, however, I often scratch my head and ask, &#8220;How am I supposed to test this??&#8221;.
Most experienced testers will tell you, &#8220;Don't test private implementation – only public API&#8221;.
&#8220;Okay&#8230; But how, does that private function get tested?&#8221;, I always asked."/>
<meta name="generator" content="Hugo 0.55.4" /> 
    
    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Testability Tip for Swift Developers – Public Over Private",
  "url": "https:\/\/www.andrewcbancroft.com\/2015\/04\/15\/testability-tip-for-swift-developers-public-over-private\/",
  "wordCount": "1074",
  "datePublished": "2015-04-15T18:52:11\x2b00:00",
  "dateModified": "2015-04-15T18:52:11\x2b00:00",
  "author": {
    "@type": "Person",
    "name": "Andrew"
  },
  "keywords": "Swift, Access Control, TDD, Unit Testing"
}
</script>



    <title>Testability Tip for Swift Developers – Public Over Private</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://www.andrewcbancroft.com/css/custom.css" rel="stylesheet"> 
    <link href="https://www.andrewcbancroft.com/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">
        
    <link href="" rel="alternate" type="application/rss+xml" title="Andrew Bancroft" /> 
    
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-sm fixed-top">
        <div class="container">
            <a class="navbar-brand" href="https://www.andrewcbancroft.com">Andrew Bancroft</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto"></ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            Notes
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://www.andrewcbancroft.com#sql-server-notes">SQL Server</a>
                        </div>
                    </li>
                    <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                Blog Articles
                            </a>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#azure">Azure</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#dimensional-modeling">Dimensional Modeling</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#general-data-concepts">General Data Concepts</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#machine-learning">Machine Learning</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#r">R</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#sql-server">SQL Server</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#statistics">Statistics</a>
                            </div>
                        </li>
                    
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            About
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://www.andrewcbancroft.comabout/andrew_bancroft/">About Andrew</a>
                            <a class="dropdown-item" href="https://github.com/andrewcbancroft">GitHub</a>
                            <a class="dropdown-item" href="https://www.linkedin.com/in/andrewcbancroft/">LinkedIn</a>
                            <a class="dropdown-item" href="https://twitter.com/andrewcbancroft">Twitter</a>
                            <a class="dropdown-item" href="https://www.youtube.com/channel/UCDPV9kMhP-b5EFRI7d812pg">YouTube</a>
                            <a class="dropdown-item" href="https://www.pluralsight.com/authors/andrew-bancroft">Pluralsight Courses</a>
                            <a class="dropdown-item" href="https://www.andrewcbancroft.com">www.andrewcbancroft.com</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>


    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                


<article>
  <div class="article">
    <header>
      <h1 class="article-title">Testability Tip for Swift Developers – Public Over Private</h1>
    </header>
    <div class="content">

    

<p>Quite often in unit testing, especially when practicing Test-Driven Development, I find myself wanting to test every single line of code. When I run up against a <code>private</code> function, however, I often scratch my head and ask, &#8220;How am I supposed to test this??&#8221;.</p>

<p>Most experienced testers will tell you, &#8220;Don't test private implementation – only public API&#8221;.</p>

<p>&#8220;Okay&#8230; But how, does that private function get tested?&#8221;, I always asked.</p>

<p>In this article, I intend to share a testability tip catered to the Swift developer community that helps alleviate this issue with testing private functions.</p>

<div class="resources">
  <div class="resources-header">
    Outline
  </div>
  

<p><ul class="resources-content">
    <li>
      <a href="#testing-and-observability">Testing and observability</a>
    </li>
    <ul>
      <li>
        <a href="#developers-as-clients-of-apis">Developers as clients of APIs</a>
      </li>
      <li>
        <a href="#tests-as-clients-of-apis">Tests as clients of APIs</a>
      </li>
    </ul></p>

<pre><code>&lt;li&gt;
  &lt;a href=&quot;#public-over-private&quot;&gt;Public over private (and internal)&lt;/a&gt;
&lt;/li&gt;
&lt;ul&gt;
  &lt;li&gt;
    &lt;a href=&quot;#reason-for-existence&quot;&gt;Public when part of a Type&amp;#8217;s reason for existence&lt;/a&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;a href=&quot;#new-type&quot;&gt;Transition many private components to new Type&lt;/a&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;li&gt;
  &lt;a href=&quot;#testing-non-public&quot;&gt;Testing non-public code&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
  &lt;a href=&quot;#related&quot;&gt;You might also enjoy…&lt;/a&gt;
&lt;/li&gt;
&lt;li&gt;
  &lt;a href=&quot;#share&quot;&gt;Was this article helpful? Please share!&lt;/a&gt;
&lt;/li&gt;
</code></pre>

<p></ul>
</div></p>

<p><a name="testing-and-observability" class="jump-target"></a></p>

<h3 id="testing-and-observability">Testing and observability</h3>

<p><a name="developers-as-clients-of-apis" class="jump-target"></a></p>

<h4 id="developers-as-clients-of-apis">Developers as clients of APIs</h4>

<p>As developers, we are &#8220;clients&#8221; of APIs on a daily basis. We interact with other developers' frameworks and libraries through the visible, observable, Application Programming Interface that they've exposed to us. It's the way they've designed for us to interact with their code.</p>

<p>Notice three words that I chose in that introductory paragraph:</p>

<ul>
<li>Visible</li>
<li>Observable</li>
<li>Exposed</li>
</ul>

<p>If we are going to use another developer's library, <em>all we have</em> as developers is the public interface that they've made visible to us&#8230; It's the only observable thing we can look at and go, &#8220;Oh! Okay, to do this, I call <em>that</em> function&#8221;. The only thing exposed are the functions and properties that the developer intends for us to see.</p>

<p><a name="tests-as-clients-of-apis" class="jump-target"></a></p>

<h4 id="tests-as-clients-of-apis">Tests as clients of APIs</h4>

<p>Have you ever viewed your unit test suite as a &#8220;client&#8221; of your code? It is!</p>

<p>And just like a developer, the unit tests in your test target interacts with <em>your</em> app's API through the same visible, observable, interface that you've exposed to them.</p>

<p>If you start to personify your test target and think of it in terms of &#8220;just another client of your code&#8221;, you begin to see that it really doesn't have any more visibility of your code than another developer would if he or she were consuming it.</p>

<p>All of this boils down to say, if it's observable, it's testable. Which means, the easiest and most natural code to test is <code>public</code> code.</p>

<p><a name="public-over-private" class="jump-target"></a></p>

<h3 id="public-over-private-and-internal">Public over private (and internal)</h3>

<p>So should <em>everything</em> be <code>public</code> instead of <code>private</code> or <code>internal</code>? Certainly not.</p>

<p>Object-oriented programming strives for data-hiding and encapsulation, so there <em>are</em> reasons to keep some things non-public.</p>

<p>Additionally, there are <a href="https://developer.apple.com/swift/blog/?id=27">certain Swift compiler optimizations</a> (which lead to run-time optimizations) that can be gained when you mark things in your Type as <code>final</code>. Using the <code>private</code> access modifier allows the compiler to <em>infer</em> that it is <code>final</code> because it's narrowly scoped to the current Type <em>only</em>. These are handy things to know, but as is always the case with optimization, avoid <em>premature</em> optimization by <em>measuring first</em> to decide if you really need them.</p>

<p>Whenever possible, I prefer <code>public</code> over the other access modifiers to help enable testing for my apps.</p>

<p>So when is &#8220;whenever possible&#8221;?</p>

<p><a name="reason-for-existence" class="jump-target"></a></p>

<h4 id="public-when-part-of-a-type-8217-s-reason-for-existence">Public when part of a Type's reason for existence</h4>

<p>Obviously, properties and functions that are part of a Type's core purpose can be marked <code>public</code>. My practice is to decide, &#8220;Is this function why this Type exists?&#8221;. If so, I mark it as <code>public</code>.</p>

<p>Note also that the Type itself needs to be marked public if it's going to be visible to your unit tests.</p>

<pre class="lang:swift decode:true " title="Public example" >// Instead of this (default --internal-- access)...
class MyClass {
    func myFunc() {
        // Performs something essential to why MyClass exists
    }
}

// Make things public...
public class MyClass {
    public func myFunc() {
        // Performs something essential to why MyClass exists
    }
}</pre>

<p><a name="new-type" class="jump-target"></a></p>

<h4 id="transition-many-private-components-to-new-type">Transition many private components to new Type</h4>

<p>Having <em>many</em> <code>private</code> properties and functions can be an indication that there needs to be a new Type created to encapsulate those components. I've heard developers talk about this situation as one that &#8220;screams, &#8216;New Type!&rsquo;&#8221;.</p>

<p>If we extract out sets of related <code>private</code> properties and functions into a new Type, those pieces of code <em>are the reason that Type exists</em>, and thus should be marked <code>public</code>. Testing, then, becomes a matter of writing unit tests for the new Type and its public API!</p>

<p>Even if you just have a few <code>private</code> code blocks in the Type you're trying to test, it can sometimes make your testing life easier to transition them to a new Type as <code>public</code> components.</p>

<p>If I'm really uncomfortable marking functions <code>public</code> in the Type where they currently exist, creating a new Type and marking them <code>public</code> there is usually the better alternative, and it immediately enables testing for that set of code.</p>

<p><a name="testing-non-public" class="jump-target"></a></p>

<h3 id="testing-non-public-code">Testing non-public code</h3>

<p>As I mentioned in the beginning, it's not good to just haphazardly go through your code and &#8220;<code>public</code> all the things!!&#8221;. After <em>appropriately</em> marking fundamental functions <code>public</code> and transitioning sets of <code>private</code> functions to new Types where they can happily live as part of <em>that</em> Type's public API, there will likely be a few <code>private</code> or <code>internal</code> things left over.</p>

<p>How do these get tested?</p>

<p>Well, ideally, these are small, simple, helper functions that are only useful when called within the Type you're working on.</p>

<p>If these functions produce observable results in the places where they're called, you end up testing these non-public components <em>implicitly</em>, that is, by testing the things that <em>are</em> <code>public</code>.</p>

<p>During the course of testing some <code>public</code> function which calls another non-public function, that non-public function's logic will be executed. If the outcome of that function's execution affects the Type's state, or the output of its <code>public</code> parent function, those are the things that you'd be able to write unit tests for, because those are the &#8220;observation points&#8221;, so to speak.</p>

<h3 id="wrapping-up">Wrapping up</h3>

<p>The bottom line is: observable == testable. Just like another developer, the suite of unit tests in your test target interacts with your app's API through the visible, observable, interface that you've exposed to them. The more observable your API components are, the more testable your code becomes. Which is why I prefer <code>public</code> over <code>private</code> whenever possible!</p>

<p><a name="related" class="jump-target"></a></p>

<div class="resources">
  <div class="resources-header">
    You might also enjoy&#8230;
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fa fa-angle-right"></i> <a href="http://www.andrewcbancroft.com/tag/unit-testing/" title="Browse All Unit Testing Articles @ andrewcbancroft.com">Browse All Unit Testing Articles @ andrewcbancroft.com</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="http://www.andrewcbancroft.com/2014/12/19/swift-unit-testing-resources/" title="Swift Unit Testing Resources">Swift Unit Testing Resources</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="http://www.andrewcbancroft.com/2014/07/22/swift-access-control-implications-for-unit-testing/" title="Swift Access Control – Implications for Unit Testing">Swift Access Control – Implications for Unit Testing</a>
    </li>
  </ul>
</div></p>

<p><a name="share" class="jump-target"></a></p>


    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andrewcbancroft" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </article>



            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 146 pages and is available on <a href="https://github.com/andrewcbancroft/datadaylife-blog">GitHub</a>. Copyright &copy; Andrew Bancroft, <time datetime="2019">2019</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>