<!DOCTYPE html>
<html lang="en">

<head>

    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-33022655-1"></script>
    <script>
            (function () {
                if (window.location.hostname === "localhost") {
                    console.log("Analytics not running on local dev.");
                    return;
                } else {
                    window.dataLayer = window.dataLayer || [];
                    function gtag() { dataLayer.push(arguments); }
                    gtag('js', new Date());

                    gtag('config', 'UA-33022655-1');
                }
            })();
    </script>

    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6356224024630676",
            enable_page_level_ads: true
        });
    </script>

    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
    <script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
    <script>
    window.addEventListener("load", function(){
    window.cookieconsent.initialise({
    "palette": {
        "popup": {
        "background": "#3e8bc5"
        },
        "button": {
        "background": "#8ec760",
        "text": "#ffffff"
        }
    }
    })});
    </script>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<meta property="og:title" content="Sharing a Core Data Model with a Swift Framework" />
<meta property="og:description" content="Updated on June 13, 2017 – Swift 3.0, Xcode 8
Code re-use is a powerful thing, but it&rsquo;s not always easy to pull off. We strive for it though, because in the long run, it makes maintaining the code far, far easier than if we just settled for copying and pasting.
With the introduction of dynamic frameworks in iOS 8, a world of possibility opened up for iOS developers to achieve some pretty cool re-use scenarios, one of which we&rsquo;re going to dive into today." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.andrewcbancroft.com/2015/08/25/sharing-a-core-data-model-with-a-swift-framework/" />
<meta property="article:published_time" content="2015-08-26T04:04:05&#43;00:00"/>
<meta property="article:modified_time" content="2015-08-26T04:04:05&#43;00:00"/>

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Sharing a Core Data Model with a Swift Framework"/>
<meta name="twitter:description" content="Updated on June 13, 2017 – Swift 3.0, Xcode 8
Code re-use is a powerful thing, but it&rsquo;s not always easy to pull off. We strive for it though, because in the long run, it makes maintaining the code far, far easier than if we just settled for copying and pasting.
With the introduction of dynamic frameworks in iOS 8, a world of possibility opened up for iOS developers to achieve some pretty cool re-use scenarios, one of which we&rsquo;re going to dive into today."/>
<meta name="generator" content="Hugo 0.55.6" /> 
    
    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "Sharing a Core Data Model with a Swift Framework",
  "url": "https:\/\/www.andrewcbancroft.com\/2015\/08\/25\/sharing-a-core-data-model-with-a-swift-framework\/",
  "wordCount": "1628",
  "datePublished": "2015-08-26T04:04:05Z",
  "dateModified": "2015-08-26T04:04:05Z",
  "author": {
    "@type": "Person",
    "name": "Andrew"
  },
  "keywords": "Swift, Core Data, Framework"

  ,"description": ""
}
</script>



    <title>Sharing a Core Data Model with a Swift Framework</title>

    
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">

    
    <link href="https://www.andrewcbancroft.com/css/custom.css" rel="stylesheet"> 
    <link href="https://www.andrewcbancroft.com/css/syntax.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Muli:400,500,700" rel="stylesheet">
        
    <link href="" rel="alternate" type="application/rss+xml" title="Andrew Bancroft" /> 
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre','code'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

</head>

<body>

    <nav class="navbar navbar-expand-lg fixed-top px-5">
            <a class="navbar-brand" href="https://www.andrewcbancroft.com"><i class="fas fa-home"></i> Andrew Bancroft</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                    <ul class="nav navbar-nav mr-auto mt-2 mt-lg-0"></ul>
                <ul class="navbar-nav">
                        <li class="nav-item">
                                <a class="nav-link" href="https://www.andrewcbancroft.com#pluralsight-courses">Pluralsight Courses</a>
                        </li>

                    <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                                aria-expanded="false">
                                Topics
                            </a>
                            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                                <h6 class="dropdown-header">iOS Development</h6>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#data-persistence">Data Persistence</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#dependency-management">Dependency Management</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#eventkit">Event Kit</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#iap">In-App Purchases</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#parse">Parse</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#patterns-and-practices">Patterns and Practices</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#react-native">React Native</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#swift-how-tos">Swift How-To's</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#swift-language-notes">Swift Language Notes</a>
                                
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#testing">Testing</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#ui-work">User Interface Work</a>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#xcode">Xcode</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#dot-net-development">.Net Development</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="https://www.andrewcbancroft.com#musings">Musings</a>
                            </div>
                        </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            Connect With Me
                        </a>
                        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="https://github.com/andrewcbancroft"><i class="fab fa-github"></i> GitHub</a>
                            <a class="dropdown-item" href="https://www.linkedin.com/in/andrewcbancroft/"><i class="fab fa-linkedin"></i> LinkedIn</a>
                            <a class="dropdown-item" href="https://twitter.com/andrewcbancroft"><i class="fab fa-twitter"></i> Twitter</a>
                            <a class="dropdown-item" href="https://www.youtube.com/channel/UCDPV9kMhP-b5EFRI7d812pg"><i class="fab fa-youtube"></i> YouTube</a>
                            <a class="dropdown-item" href="https://www.pluralsight.com/authors/andrew-bancroft"><i class="fas fa-play"></i> Pluralsight Courses</a>
                            <a class="dropdown-item" href="https://dataday.life"><i class="fas fa-link"></i> www.dataday.life</a>
                            <a class="dropdown-item" href="https://www.andrewcbancroft.com/index.xml"><i class="fas fa-rss"></i> Feed</a>
                        </div>
                    </li>
                </ul>
        </div>
    </nav>

    
    
    
    
    
    
    
    

    
    <div class="container">
        <div class="row">
            <div class="col-sm-12">

                


<article>
  <div class="article">
    <header>
        <div class="alert alert-primary" role="alert">
            Learning about data technologies on iOS? <br/><br/>
            I've created courses on <a href="http://bit.ly/core-data-swift" class="alert-link">Core Data</a>, <a href="http://bit.ly/cloudkit-fundamentals" class="alert-link">CloudKit</a>, and <a href="http://bit.ly/core-data-primary-keys" class="alert-link">the Big Picture of Data Persistence on iOS</a> for <a href="http://bit.ly/ps-author-page" class="alert-link">Pluralsight</a>.  <br/><br/>Deepen your understanding by checking them out!
          </div>
      <h1 class="article-title">Sharing a Core Data Model with a Swift Framework</h1>
    </header>
    <div class="content">

    <p></p>

    

<p><small>Updated on June 13, 2017 – Swift 3.0, Xcode 8</small></p>

<p>Code re-use is a powerful thing, but it&rsquo;s not always easy to pull off. We strive for it though, because in the long run, it makes maintaining the code far, far easier than if we just settled for copying and pasting.</p>

<p>With the introduction of dynamic frameworks in iOS 8, a world of possibility opened up for iOS developers to achieve some pretty cool re-use scenarios, one of which we&rsquo;re going to dive into today.</p>

<p>Not only can we share <em>code</em> between projects, we can also share Core Data <em>models</em> between projects by utilizing frameworks!</p>

<p>Perhaps you&rsquo;re working on an iOS + Mac app combination and the data model for each is identical. Maybe you&rsquo;re building several iOS apps that have different user interfaces but share some underlying persistence-layer models. Whatever the case may be, wouldn&rsquo;t it be awesome to design the Core Data model once and share it between your projects?</p>

<p><a name="example-scenario" class="jump-target"></a></p>

<h3 id="example-scenario">Example scenario</h3>

<p>Our working example for this walkthrough will be the following:</p>

<p>Our team is building an <strong>iOS app</strong> and a <strong>Mac app</strong> and the <strong>underlying data model will be exactly the same</strong> between them. The only difference between the apps will be the target platform.</p>

<p>The app will target car enthusiasts everywhere – we will empower car fanatics to manage of a list of their favorite cars.</p>

<p>We&rsquo;ll be creating two Xcode projects during this walkthrough: One will be the framework and will be called &ldquo;CarKit&#8221;. The other will be a single view iOS application. We won&rsquo;t actually dive into the Mac project, but one could imagine the process being very similar for importing CarKit into the Mac application when it came time to build that one.</p>

<p>I&rsquo;m providing a completed CarKit + Carz package for you to look at over at GitHub:</p>

<div class="resources">
  <div class="resources-header">
    Resources
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fab fa-github fa-lg"></i> <a href="https://github.com/andrewcbancroft/CoreDataFrameworkExample" title="Core Data Framework Example">CarKit + Carz Core Data Framework Example</a>
    </li>
  </ul>
</div></p>

<p>Let&rsquo;s get started!</p>

<p><a name="create-swift-framework-project" class="jump-target"></a></p>

<h3 id="creating-a-swift-framework-project">Creating a Swift framework project</h3>

<p>To get started with creating a Swift framework, begin with Xcode&rsquo;s New Project dialog (File -&gt; New -&gt; Project&#8230;). Typically we stay in the realm of the &ldquo;iOS Application&#8221; project templates, but if you click &ldquo;Framework &amp; library&#8221;, you&rsquo;ll see the option to create a new Cocoa Touch Framework:</p>

<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/01-New-Project-Framework.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/01-New-Project-Framework.png" alt="01 - New Project - Framework" width="778" height="490" class="alignnone size-full wp-image-12239" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/01-New-Project-Framework.png 778w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/01-New-Project-Framework-300x189.png 300w" sizes="(max-width: 778px) 100vw, 778px" /></a></p>

<p>In keeping with Apple&rsquo;s &ldquo;___Kit&#8221; theme, we&rsquo;ll name our framework &ldquo;CarKit&#8221;:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/02-Project-Name.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/02-Project-Name.png" alt="02 - Project Name" width="760" height="467" class="alignnone size-full wp-image-12240" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/02-Project-Name.png 760w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/02-Project-Name-300x184.png 300w" sizes="(max-width: 760px) 100vw, 760px" /></a></p>

<p><a name="add-data-model-file" class="jump-target"></a></p>

<h4 id="add-a-data-model-file">Add a data model file</h4>

<p>Once the framework project has been created, we&rsquo;re set to drop in a new Data Model file from Xcode&rsquo;s new file dialog (File -&gt; New -&gt; File&#8230;). Choose Core Data, and then Data Model:</p>

<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/03-New-File-Core-Data-Data-Model.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/03-New-File-Core-Data-Data-Model.png" alt="03 - New File - Core Data - Data Model" width="750" height="444" class="alignnone size-full wp-image-12241" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/03-New-File-Core-Data-Data-Model.png 750w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/03-New-File-Core-Data-Data-Model-300x178.png 300w" sizes="(max-width: 750px) 100vw, 750px" /></a></p>

<p>Give the data model file a name that seems to fit your situation. For our example, let&rsquo;s name it &ldquo;CarModel&#8221;:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/04-Model-Name.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/04-Model-Name.png" alt="04 - Model Name" width="748" height="740" class="alignnone size-full wp-image-12242" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/04-Model-Name.png 748w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/04-Model-Name-300x297.png 300w" sizes="(max-width: 748px) 100vw, 748px" /></a></p>

<p><a name="add-model-attributes" class="jump-target"></a></p>

<h4 id="add-model-attributes">Add model attributes</h4>

<p>Next it&rsquo;s time to actually add attributes to the model. Since our theme is cars here, we&rsquo;ll stick with three simple attributes: <code>year</code>, <code>make</code>, and <code>model</code>:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/05-Complete-Model.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/05-Complete-Model-1024x656.png" alt="05 - Complete Model" width="1024" height="656" class="alignnone size-large wp-image-12243" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/05-Complete-Model-1024x656.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/05-Complete-Model-300x192.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/05-Complete-Model.png 1399w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><a name="create-nsmanagedobject-subclass" class="jump-target"></a></p>

<h4 id="create-nsmanagedobject-subclass">Create NSManagedObject subclass</h4>

<p>With the model attributes all configured, it&rsquo;s time to create an <code>NSManagedObject</code> subclass. This will make consuming the model much easier in client applications. I&rsquo;ve actually <a href="http://www.andrewcbancroft.com/2014/07/17/implement-nsmanagedobject-subclass-in-swift/">written up a full walk through on creating an NSManagedObject subclass in Swift</a> as there are some nuances. Feel free to read up on that if you so desire!<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/06-NSManagedObject-Subclass.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/06-NSManagedObject-Subclass.png" alt="06 - NSManagedObject Subclass" width="517" height="490" class="alignnone size-full wp-image-12244" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/06-NSManagedObject-Subclass.png 517w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/06-NSManagedObject-Subclass-300x284.png 300w" sizes="(max-width: 517px) 100vw, 517px" /></a></p>

<p>Be absolutely sure to mark your <code>NSManagedObject</code> subclass and its properties <code>public</code> – otherwise, the client app won&rsquo;t be able to see the class or its properties:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/061-NSManagedObjectSubclass-Public.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/061-NSManagedObjectSubclass-Public.png" alt="061 - NSManagedObjectSubclass Public" width="671" height="351" class="alignnone size-full wp-image-12255" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/061-NSManagedObjectSubclass-Public.png 671w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/061-NSManagedObjectSubclass-Public-300x157.png 300w" sizes="(max-width: 671px) 100vw, 671px" /></a></p>

<p>As I point out in <a href="http://www.andrewcbancroft.com/2014/07/17/implement-nsmanagedobject-subclass-in-swift/">Implement NSManagedObject Subclass in Swift</a>, you need to set the Module property in the Data Model Inspector to be CarKit (which is the same as the &ldquo;Current Project Module&#8221; option for this example):<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class-1024x213.png" alt="07 - Change Entity Class" width="1024" height="213" class="alignnone size-large wp-image-12245" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class-1024x213.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class-300x62.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class-768x160.png 768w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/07-Change-Entity-Class.png 1404w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><a name="build-inspect-outputs" class="jump-target"></a></p>

<h4 id="build-and-inspect-outputs">Build and inspect outputs</h4>

<p>We&rsquo;ve got a framework, and we&rsquo;ve got a Data Model with attributes and an <code>NSManagedObject</code> subclass all appropriately implemented. Now it&rsquo;s time to build the project and inspect the output of the build!</p>

<p>Command + B to build, and then head up to the File menu and choose Project Settings:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/08-Window-Projects.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/08-Window-Projects.png" alt="08 - Window - Projects" width="292" height="492" class="alignnone size-full wp-image-12246" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/08-Window-Projects.png 292w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/08-Window-Projects-178x300.png 178w" sizes="(max-width: 292px) 100vw, 292px" /></a></p>

<p>In the Project Settings area that appears, click the small gray arrow under the &ldquo;Derived Data&#8221; section:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/09-CarKit-Projects-Window.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/09-CarKit-Projects-Window.png" alt="09 - CarKit - Projects Window" width="612" height="374" class="alignnone size-full wp-image-12247" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/09-CarKit-Projects-Window.png 612w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/09-CarKit-Projects-Window-300x183.png 300w" sizes="(max-width: 612px) 100vw, 612px" /></a></p>

<p>Next, find the derived data folder for your project. It should be named the same as your project with a set of random characters after. Sometimes there will be multiple folders that could be your project. You can look at the last modified date to help figure you figure out which one was most recently built and choose that one.</p>

<p>Expand the Build folder down to Build -&gt; Products -&gt; Debug-iphonesimulator. There you should see the CarKit.framework artifact, and within it, everything that&rsquo;s needed to be able to utilize the data model in a client application. Awesome!<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd-1024x733.png" alt="10 - CarKit - Finder - Includes momd" width="1024" height="733" class="alignnone size-large wp-image-12248" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd-1024x733.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd-300x215.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd-768x550.png 768w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/10-CarKit-Finder-Includes-momd.png 1064w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><strong>Note:</strong> This framework is not production-ready. It&rsquo;s a little more involved to create a framework that one can run on a device / pass validation when submitting to the app store. The development of the framework remains the same, but the <em>build</em> phases and procedures must be modified to make it &ldquo;universal&#8221;. Rather than overly complicate this walkthrough, I recommend reviewing &ldquo;<a href="https://kodmunki.wordpress.com/2015/03/04/cocoa-touch-frameworks-for-ios8-remix/">Universal Cocoa Touch Frameworks for iOS 8 – (Remix)</a> by <a href="https://twitter.com/kodmunki">@kodmunki</a> to create a &ldquo;universal&#8221; framework capable of being run in the simulator and on iOS devices.</p>

<p><a name="create-framework-dependent-app" class="jump-target"></a></p>

<h3 id="creating-the-framework-dependent-app">Creating the framework-dependent app</h3>

<p>With the framework built, it&rsquo;s time to create the iOS app that will utilize that framework and its packaged assets! Begin a new project from File -&gt; New -&gt; Project and select &ldquo;Single View Application&#8221;. I&rsquo;ll name our example app &ldquo;Carz&#8221;. <strong>Ensure that &ldquo;Use Core Data&#8221; is selected</strong> so that you get the boilerplate Core Data code put into your project by Xcode:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/11-New-Single-View-App-Carz.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/11-New-Single-View-App-Carz.png" alt="11 - New Single View App - Carz" width="755" height="492" class="alignnone size-full wp-image-12249" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/11-New-Single-View-App-Carz.png 755w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/11-New-Single-View-App-Carz-300x195.png 300w" sizes="(max-width: 755px) 100vw, 755px" /></a></p>

<p><a name="remove-xcode-generated-xcdatamodeld" class="jump-target"></a></p>

<h4 id="remove-xcode-generated-xcdatamodeld-file">Remove Xcode-generated .xcdatamodeld file</h4>

<p>When you select &ldquo;Use Core Data&#8221; in the project creation window, Xcode automatically generates some boilerplate code, which we want. But it also gives us a &ldquo;Carz.xcdatamodeld&#8221; file, which we will not need because we&rsquo;ll use the model that&rsquo;s found in CarKit. Remove the &ldquo;Carz.xcdatamodeld&#8221; file that Xcode provides for you:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/12-Remove-default-data-model-from-new-project.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/12-Remove-default-data-model-from-new-project-1024x475.png" alt="12 - Remove default data model from new project" width="1024" height="475" class="alignnone size-large wp-image-12250" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/12-Remove-default-data-model-from-new-project-1024x475.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/12-Remove-default-data-model-from-new-project-300x139.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/12-Remove-default-data-model-from-new-project.png 1394w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><a name="obtain-framework-bundle-identifier" class="jump-target"></a></p>

<h4 id="obtain-framework-bundle-identifier">Obtain framework Bundle Identifier</h4>

<p>Speaking of using the CarKit Core Data model, we&rsquo;re now ready to configure that piece of the app. To do this part, you will need to know the Bundle Identifier from your framework project. To find out what it is, jump back over to the framework project, click the top-level node in the project navigator, click on the framework target name, and look under the General tab of the project configuration. There you&rsquo;ll find the Bundle Identifier, which you can copy to your clipboard:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/13-CarKit-Bundle-Identifier.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/13-CarKit-Bundle-Identifier-1024x301.png" alt="13 - CarKit Bundle Identifier" width="1024" height="301" class="alignnone size-large wp-image-12251" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/13-CarKit-Bundle-Identifier-1024x301.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/13-CarKit-Bundle-Identifier-300x88.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/13-CarKit-Bundle-Identifier.png 1137w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><a name="replace-managed-object-model-property" class="jump-target"></a></p>

<h4 id="replace-managedobjectmodel-property-initialization">Replace managedObjectModel property initialization</h4>

<p>Out of the box, Xcode generates some code to help locate your Core Data model file. The boilerplate <code>managedObjectModel</code> property looks like this:</p>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="ln">1</span><span class="kr">lazy</span> <span class="kd">var</span> <span class="nv">managedObjectModel</span><span class="p">:</span> <span class="n">NSManagedObjectModel</span> <span class="p">=</span> <span class="p">{</span>
<span class="ln">2</span>    <span class="c1">// The managed object model for the application. This property is not optional. It is a fatal error for the application not to be able to find and load its model.</span>
<span class="ln">3</span>    <span class="kd">let</span> <span class="nv">modelURL</span> <span class="p">=</span> <span class="n">NSBundle</span><span class="p">.</span><span class="n">mainBundle</span><span class="p">().</span><span class="n">URLForResource</span><span class="p">(</span><span class="s">&#34;DataModelFileName&#34;</span><span class="p">,</span> <span class="n">withExtension</span><span class="p">:</span> <span class="s">&#34;momd&#34;</span><span class="p">)</span><span class="o">!</span>
<span class="ln">4</span>    <span class="k">return</span> <span class="n">NSManagedObjectModel</span><span class="p">(</span><span class="n">contentsOfURL</span><span class="p">:</span> <span class="n">modelURL</span><span class="p">)</span><span class="o">!</span>
<span class="ln">5</span><span class="p">}()</span></code></pre></div>
<p>However, this won&rsquo;t work for us, because we&rsquo;re going to use the data model from CarKit, and CarKit is not in the <code>mainBundle()</code>. This is why we jumped over and copied the Bundle Identifier for CarKit in the previous step. To locate the data model file in <em>that</em> bundle, you&rsquo;ll replace the <code>managedObjectModel</code> initialization step to the following (for CarKit):</p>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="ln">1</span><span class="kr">lazy</span> <span class="kd">var</span> <span class="nv">managedObjectModel</span><span class="p">:</span> <span class="n">NSManagedObjectModel</span> <span class="p">=</span> <span class="p">{</span>
<span class="ln">2</span>        <span class="c1">// The managed object model for the application. This property is not optional. It is a fatal error for the application not to be able to find and load its model.</span>
<span class="ln">3</span>        <span class="kd">let</span> <span class="nv">carKitBundle</span> <span class="p">=</span> <span class="n">Bundle</span><span class="p">(</span><span class="n">identifier</span><span class="p">:</span> <span class="s">&#34;com.andrewcbancroft.CarKit&#34;</span><span class="p">)</span>
<span class="ln">4</span>        
<span class="ln">5</span>        <span class="kd">let</span> <span class="nv">modelURL</span> <span class="p">=</span> <span class="n">carKitBundle</span><span class="o">!</span><span class="p">.</span><span class="n">url</span><span class="p">(</span><span class="n">forResource</span><span class="p">:</span> <span class="s">&#34;CarModel&#34;</span><span class="p">,</span> <span class="n">withExtension</span><span class="p">:</span> <span class="s">&#34;momd&#34;</span><span class="p">)</span><span class="o">!</span>
<span class="ln">6</span>        <span class="k">return</span> <span class="n">NSManagedObjectModel</span><span class="p">(</span><span class="n">contentsOf</span><span class="p">:</span> <span class="n">modelURL</span><span class="p">)</span><span class="o">!</span>
<span class="ln">7</span><span class="p">}()</span></code></pre></div>
<p><a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate-1024x394.png" alt="16 - AppDelegate" width="1024" height="394" class="alignnone size-large wp-image-12253" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate-1024x394.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate-300x115.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate-768x296.png 768w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/16-AppDelegate.png 1213w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p>Recall that &ldquo;CarModel&#8221; is the name of the Core Data model we created for the framework in CarKit. We simply look for that artifact by calling <code>URLForResource:withExtension:</code> on the <code>carKitBundle</code> to initialize an <code>NSManagedObjectModel</code> instance.</p>

<p><a name="add-carkit-framework" class="jump-target"></a></p>

<h4 id="add-carkit-framework-to-project-and-embed-binary">Add CarKit framework to project and embed binary</h4>

<p>Now it&rsquo;s time to actually bring in the framework for use within our app. I typically open up a Finder window and drag over a copy of the framework (in this case, the CarKit.framework file) into my project. Feel free to organize it into a &ldquo;lib&#8221; folder.</p>

<p>Assuming that you go through all the necessary steps to make the framework production-ready, you&rsquo;ll want to embed the binary and ensure that it&rsquo;s referenced in the &ldquo;Linked Frameworks and Libraries&#8221; portion of your project configuration:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/15-Embed-CarKit-and-Link-CarKit.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/15-Embed-CarKit-and-Link-CarKit-1024x634.png" alt="15 - Embed CarKit and Link CarKit" width="1024" height="634" class="alignnone size-large wp-image-12252" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/15-Embed-CarKit-and-Link-CarKit-1024x634.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/15-Embed-CarKit-and-Link-CarKit-300x186.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/15-Embed-CarKit-and-Link-CarKit.png 1399w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<p><a name="take-for-test-drive" class="jump-target"></a></p>

<h4 id="taking-the-model-out-for-a-test-drive-pun-intended">Taking the model out for a test drive (pun intended)</h4>

<p>It&rsquo;s simple enough to try things out by writing a simple little snippet of code in the <code>AppDelegate</code>:</p>
<div class="highlight"><pre class="chroma"><code class="language-swift" data-lang="swift"><span class="ln"> 1</span><span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="kc">_</span> <span class="n">application</span><span class="p">:</span> <span class="n">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="n">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="n">UIApplicationLaunchOptionsKey</span><span class="p">:</span> <span class="nb">Any</span><span class="p">]?)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>
<span class="ln"> 2</span>    <span class="c1">// Override point for customization after application launch.</span>
<span class="ln"> 3</span>    
<span class="ln"> 4</span>    <span class="kd">let</span> <span class="nv">newCar</span> <span class="p">=</span> <span class="n">NSEntityDescription</span><span class="p">.</span><span class="n">insertNewObject</span><span class="p">(</span><span class="n">forEntityName</span><span class="p">:</span> <span class="s">&#34;Car&#34;</span><span class="p">,</span> <span class="n">into</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">managedObjectContext</span><span class="o">!</span><span class="p">)</span> <span class="k">as</span><span class="o">!</span> <span class="n">Car</span>
<span class="ln"> 5</span>    <span class="n">newCar</span><span class="p">.</span><span class="n">year</span> <span class="p">=</span> <span class="mi">2015</span>
<span class="ln"> 6</span>    <span class="n">newCar</span><span class="p">.</span><span class="n">make</span> <span class="p">=</span> <span class="s">&#34;Tesla&#34;</span>
<span class="ln"> 7</span>    <span class="n">newCar</span><span class="p">.</span><span class="n">model</span> <span class="p">=</span> <span class="s">&#34;S&#34;</span>
<span class="ln"> 8</span>    
<span class="ln"> 9</span>    <span class="k">do</span> <span class="p">{</span>
<span class="ln">10</span>        <span class="k">try</span> <span class="kc">self</span><span class="p">.</span><span class="n">managedObjectContext</span><span class="p">?.</span><span class="n">save</span><span class="p">()</span>
<span class="ln">11</span>    <span class="p">}</span> <span class="k">catch</span> <span class="kc">_</span> <span class="p">{</span>
<span class="ln">12</span>    <span class="p">}</span>
<span class="ln">13</span>    
<span class="ln">14</span>    <span class="kd">let</span> <span class="nv">fetchRequest</span> <span class="p">=</span> <span class="n">NSFetchRequest</span><span class="p">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">NSFetchRequestResult</span><span class="o">&gt;</span><span class="p">(</span><span class="n">entityName</span><span class="p">:</span> <span class="s">&#34;Car&#34;</span><span class="p">)</span>
<span class="ln">15</span>    <span class="kd">let</span> <span class="nv">cars</span> <span class="p">=</span> <span class="p">(</span><span class="k">try</span><span class="o">!</span> <span class="kc">self</span><span class="p">.</span><span class="n">managedObjectContext</span><span class="p">?.</span><span class="n">fetch</span><span class="p">(</span><span class="n">fetchRequest</span><span class="p">))</span> <span class="k">as</span><span class="o">!</span> <span class="p">[</span><span class="n">Car</span><span class="p">]</span>
<span class="ln">16</span>    
<span class="ln">17</span>    <span class="bp">print</span><span class="p">(</span><span class="n">cars</span><span class="p">,</span> <span class="n">terminator</span><span class="p">:</span> <span class="s">&#34;&#34;</span><span class="p">)</span>
<span class="ln">18</span>    
<span class="ln">19</span>    <span class="k">return</span> <span class="kc">true</span>
<span class="ln">20</span><span class="p">}</span></code></pre></div>
<p>This code simply obtains a new Car object, sets some properties, and saves it all with the <code>managedObjectContext</code> instance that&rsquo;s configured in the <code>AppDelegate</code>.</p>

<p>Then it goes and performs a fetch request to grab all the <code>Car</code> objects and prints them. The results? See for yourself:<br />
<a href="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result.png"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result-1024x592.png" alt="17 - Final Result" width="1024" height="592" class="alignnone size-large wp-image-12254" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result-1024x592.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result-300x173.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result-768x444.png 768w, https://www.andrewcbancroft.com/wp-content/uploads/2015/08/17-Final-Result.png 1470w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>

<h3 id="wrapping-up">Wrapping up</h3>

<p>This walkthrough guided you through the process of creating a framework for the purpose of sharing a Core Data model with multiple projects. My hope is that you&rsquo;re now empowered to make use of _re_use by utilizing Swift frameworks to share even portions of your persistence layer!</p>

<p><a name="related" class="jump-target"></a></p>

<div class="resources">
  <div class="resources-header">
    You might also enjoy&#8230;
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2016/07/10/using-a-core-data-model-in-swift-playgrounds/" title="Using a Core Data Model in Swift Playgrounds">Using a Core Data Model in Swift Playgrounds</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/02/25/using-swift-to-seed-a-core-data-database/" title="Using Swift to Seed a Core Data Database">Using Swift to Seed a Core Data Database</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/02/18/core-data-cheat-sheet-for-swift-ios-developers/" title="Core Data Cheat Sheet for Swift iOS Developers">Core Data Cheat Sheet for Swift iOS Developers</a>
    </li>
    <li>
      <i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/01/13/unit-testing-model-layer-core-data-swift/" title="Unit Testing Model Layer with Core Data and Swift">Unit Testing Model Layer with Core Data and Swift</a>
    </li>
  </ul>
</div></p>

<p><a name="course" class="jump-target"></a></p>

<div class="resources">
  <div class="resources-header">
    Resources
  </div>
  

<p><ul class="resources-content">
    <li>
      <i class="fas fa-video"></i> <a href="http://bit.ly/ps-core-data-swift" target="_blank">Core Data Fundamentals with Swift</a><br /> <a href="http://bit.ly/ps-core-data-swift" target="_blank"><img src="https://www.andrewcbancroft.com/wp-content/uploads/2017/04/ps-core-data-fundamentals-swift-1024x576.png" alt="Core Data Fundamentals with Swift" width="1024" height="576" class="alignnone size-large wp-image-13163" srcset="https://www.andrewcbancroft.com/wp-content/uploads/2017/04/ps-core-data-fundamentals-swift-1024x576.png 1024w, https://www.andrewcbancroft.com/wp-content/uploads/2017/04/ps-core-data-fundamentals-swift-300x169.png 300w, https://www.andrewcbancroft.com/wp-content/uploads/2017/04/ps-core-data-fundamentals-swift-768x432.png 768w, https://www.andrewcbancroft.com/wp-content/uploads/2017/04/ps-core-data-fundamentals-swift.png 1539w" sizes="(max-width: 1024px) 100vw, 1024px" /></a>
    </li>
  </ul>
</div></p>

<p><a name="share" class="jump-target"></a></p>


    <aside>
      
      
      <div class="resources">
        <div class="resources-header">
            You might also enjoy...
        </div>
        
        <ul class="resources-content">
            
            <li><i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/03/05/displaying-data-with-nsfetchedresultscontroller-and-swift/">Displaying Data With NSFetchedResultsController and Swift</a></li>
            
            <li><i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/02/25/using-swift-to-seed-a-core-data-database/">Using Swift to Seed a Core Data Database</a></li>
            
            <li><i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/02/18/core-data-cheat-sheet-for-swift-ios-developers/">Core Data Cheat Sheet for Swift iOS Developers</a></li>
            
            <li><i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2015/01/13/unit-testing-model-layer-core-data-swift/">Unit Testing Model Layer with Core Data and Swift</a></li>
            
            <li><i class="fa fa-angle-right"></i> <a href="https://www.andrewcbancroft.com/2014/07/17/implement-nsmanagedobject-subclass-in-swift/">Implement NSManagedObject Subclass in Swift</a></li>
            
        <ul>
      
    </aside>

    <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "andrewcbancroft" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  </article>



            </div>

        </div>
    </div>

    

    <footer class="footer text-center">
        <div class="container">
            <span class="text-muted">This project contains 163 pages and is available on <a href="https://github.com/andrewcbancroft/andrewcbancroft-blog/tree/master/content/blog">GitHub</a>. Copyright &copy; Andrew Bancroft, <time datetime="2019">2019</time>.</span>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>

</body>

</html>